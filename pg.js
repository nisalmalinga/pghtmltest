!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.jso=b():a.jso=b()}(window,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.r=function(a){Object.defineProperty(a,"__esModule",{value:!0})},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=90)}([function(a,b,c){var d=c(40)("wks"),f=c(25),g=c(1).Symbol,h="function"==typeof g;(a.exports=function(a){return d[a]||(d[a]=h&&g[a]||(h?g:f)("Symbol."+a))}).store=d},function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)},function(a){var b=a.exports={version:"2.5.3"};"number"==typeof __e&&(__e=b)},function(a,b,c){var d=c(10);a.exports=function(a){if(!d(a))throw TypeError(a+" is not an object!");return a}},function(a,b,c){var d=c(16),f=c(44);a.exports=c(9)?function(a,b,c){return d.f(a,b,f(1,c))}:function(a,b,c){return a[b]=c,a}},function(b,d,e){var j=e(1),k=e(2),m=e(4),i=e(8),o=e(15),a=function(c,e,q){var r,t,u,x,z=c&a.F,h=c&a.G,d=c&a.S,v=c&a.P,y=c&a.B,g=h?j:d?j[e]||(j[e]={}):(j[e]||{}).prototype,b=h?k:k[e]||(k[e]={}),w=b.prototype||(b.prototype={});for(r in h&&(q=e),q)u=((t=!z&&g&&void 0!==g[r])?g:q)[r],x=y&&t?o(u,j):v&&"function"==typeof u?o(Function.call,u):u,g&&i(g,r,u,c&a.U),b[r]!=u&&m(b,r,x),v&&w[r]!=u&&(w[r]=u)};j.core=k,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,b.exports=a},function(a){a.exports={}},function(a){var b={}.hasOwnProperty;a.exports=function(a,c){return b.call(a,c)}},function(b,d,e){var f=e(1),g=e(4),h=e(7),i=e(25)("src"),j=Function.toString,k=(""+j).split("toString");e(2).inspectSource=function(a){return j.call(a)},(b.exports=function(b,c,d,e){var a="function"==typeof d;a&&(h(d,"name")||g(d,"name",c)),b[c]!==d&&(a&&(h(d,i)||g(d,i,b[c]?""+b[c]:k.join(c+""))),b===f?b[c]=d:e?b[c]?b[c]=d:g(b,c,d):(delete b[c],g(b,c,d)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[i]||j.call(this)})},function(a,b,c){a.exports=!c(27)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(a){a.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),d=function(){function a(b){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a),console.log("Initializing a loader with url "+b),this.url=b}return c(a,[{key:"execute",value:function(){}}]),a}();b.default=d},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c={epoch:function(){return Math.round(new Date().getTime()/1e3)},debug:!1,uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random();return("x"==a?b:8|3&b).toString(16)})},getResponseFromURL:function(a){return-1===a.indexOf("#")?-1===a.indexOf("?")?{}:c.parseQueryString(a.substring(a.indexOf("?")+1)):c.parseQueryString(a.substring(a.indexOf("#")+1))},parseQueryString:function(a){for(var b,c=/\+/g,d=/([^&;=]+)=?([^&;]*)/g,e=function(a){return decodeURIComponent(a.replace(c," "))},f={};b=d.exec(a);)f[e(b[1])]=e(b[2]);return f},scopeList:function(a){return c.uniqueList(a).join(" ")},uniqueList:function(a){for(var b={},c=[],d=0;d<a.length;d++)b[a[d]]=1;for(var e in b)b.hasOwnProperty(e)&&c.push(e);return c},log:function(){if(console&&console.log&&c.debug){var a=Array.prototype.slice.call(arguments);a.unshift("[JSO]"),console.log.apply(console,a)}},encodeQS:function(a){var b,c="",d=0;for(b in a)c+=(0==d++?"":"&")+encodeURIComponent(b)+"="+encodeURIComponent(a[b]);return c},encodeURL:function(a,b){var c,d=a,e=0,f=-1===a.indexOf("?")?"?":"&";for(c in b)d+=(0==e++?f:"&")+encodeURIComponent(c)+"="+encodeURIComponent(b[c]);return d}};b.default=c},function(a){var b={}.toString;a.exports=function(a){return b.call(a).slice(8,-1)}},function(a){a.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}},function(a,b,c){var d=c(14);a.exports=function(a,b,c){if(d(a),void 0===b)return a;return 1===c?function(c){return a.call(b,c)}:2===c?function(c,d){return a.call(b,c,d)}:3===c?function(c,d,e){return a.call(b,c,d,e)}:function(){return a.apply(b,arguments)}}},function(a,b,c){var d=c(3),f=c(87),g=c(86),h=Object.defineProperty;b.f=c(9)?Object.defineProperty:function(a,b,c){if(d(a),b=g(b,!0),d(c),f)try{return h(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a}},function(a,b,c){"use strict";var d=c(14);a.exports.f=function(a){return new function(a){var b,c;this.promise=new a(function(a,d){if(void 0!==b||void 0!==c)throw TypeError("Bad Promise constructor");b=a,c=d}),this.resolve=d(b),this.reject=d(c)}(a)}},function(a,b,c){var d=c(16).f,f=c(7),g=c(0)("toStringTag");a.exports=function(a,b,c){a&&!f(a=c?a:a.prototype,g)&&d(a,g,{configurable:!0,value:b})}},function(a,b,c){var d=c(13),f=c(0)("toStringTag"),g="Arguments"==d(function(){return arguments}());a.exports=function(a){var b,c,e;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(c=function(a,b){try{return a[b]}catch(a){}}(b=Object(a),f))?c:g?d(b):"Object"==(e=d(b))&&"function"==typeof b.callee?"Arguments":e}},function(a,b,c){var d=c(40)("keys"),f=c(25);a.exports=function(a){return d[a]||(d[a]=f(a))}},function(a){var b=Math.ceil,c=Math.floor;a.exports=function(a){return isNaN(a=+a)?0:(0<a?c:b)(a)}},function(a){a.exports=function(a){if(null==a)throw TypeError("Can't call method on  "+a);return a}},function(a,b,c){var d=c(43),f=c(22);a.exports=function(a){return d(f(a))}},function(a,b,c){var d=c(84),f=c(39);a.exports=Object.keys||function(a){return d(a,f)}},function(a){var b=0,c=Math.random();a.exports=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++b+c).toString(36))}},function(a,b,c){var d=c(10),f=c(1).document,g=d(f)&&d(f.createElement);a.exports=function(a){return g?f.createElement(a):{}}},function(a){a.exports=function(a){try{return!!a()}catch(a){return!0}}},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),d=function(){function a(b){for(var c in function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a),b)this[c]=b[c]}return c(a,[{key:"set",value:function(a,b){return this[a]=b,this}}]),a}();b.default=d},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d,e=c(28),f=(d=e)&&d.__esModule?d:{default:d},g=function(){function a(){return function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a),function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}(a,f.default),a}();b.default=g},function(a,b,c){var d=c(3),f=c(10),g=c(17);a.exports=function(a,b){if(d(a),f(b)&&b.constructor===a)return b;var c=g.f(a);return(0,c.resolve)(b),c.promise}},function(a){a.exports=function(a){try{return{e:!1,v:a()}}catch(a){return{e:!0,v:a}}}},function(j,e,k){var m,n,q,t=k(15),u=k(61),a=k(34),c=k(26),s=k(1),f=s.process,l=s.setImmediate,x=s.clearImmediate,z=s.MessageChannel,d=s.Dispatch,v=0,A={},g=function(){var a=+this;if(A.hasOwnProperty(a)){var b=A[a];delete A[a],b()}},b=function(a){g.call(a.data)};l&&x||(l=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return A[++v]=function(){u("function"==typeof a?a:Function(a),b)},m(v),v},x=function(a){delete A[a]},"process"==k(13)(f)?m=function(a){f.nextTick(t(g,a,1))}:d&&d.now?m=function(a){d.now(t(g,a,1))}:z?(q=(n=new z).port2,n.port1.onmessage=b,m=t(q.postMessage,q,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(m=function(a){s.postMessage(a+"","*")},s.addEventListener("message",b,!1)):m="onreadystatechange"in c("script")?function(b){a.appendChild(c("script")).onreadystatechange=function(){a.removeChild(this),g.call(b)}}:function(a){setTimeout(t(g,a,1),0)}),j.exports={set:l,clear:x}},function(a,b,c){var d=c(3),f=c(14),g=c(0)("species");a.exports=function(a,b){var c,e=d(a).constructor;return void 0===e||null==(c=d(e)[g])?b:f(c)}},function(a,b,c){var d=c(1).document;a.exports=d&&d.documentElement},function(a){a.exports=!1},function(b,e,g){"use strict";var q=g(35),r=g(5),j=g(8),i=g(4),o=g(7),a=g(6),c=g(74),s=g(18),f=g(71),l=g(0)("iterator"),p=!([].keys&&"next"in[].keys()),h=function(){return this};b.exports=function(d,e,t,n,u,v,g){c(t,e,n);var b,y,z,A=function(a){if(!p&&a in D)return D[a];return"keys"===a||"values"===a?function(){return new t(this,a)}:function(){return new t(this,a)}},k=e+" Iterator",B="values"==u,x=!1,D=d.prototype,F=D[l]||D["@@iterator"]||u&&D[u],G=!p&&F||A(u),H=u?B?A("entries"):G:void 0,E="Array"==e&&D.entries||F;if(E&&(z=f(E.call(new d)))!==Object.prototype&&z.next&&(s(z,k,!0),q||o(z,l)||i(z,l,h)),B&&F&&"values"!==F.name&&(x=!0,G=function(){return F.call(this)}),q&&!g||!p&&!x&&D[l]||i(D,l,G),a[e]=G,a[k]=h,u)if(b={values:B?G:A("values"),keys:v?G:A("keys"),entries:H},g)for(y in b)y in D||j(D,y,b[y]);else r(r.P+r.F*(p||x),e,b);return b}},function(a,b,c){var d=c(0)("unscopables"),f=Array.prototype;null==f[d]&&c(4)(f,d,{}),a.exports=function(a){f[d][a]=!0}},function(a,b,c){var d=c(22);a.exports=function(a){return Object(d(a))}},function(a){a.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(a,b,c){var d=c(1),f=d["__core-js_shared__"]||(d["__core-js_shared__"]={});a.exports=function(a){return f[a]||(f[a]={})}},function(a,b,c){var d=c(21),f=Math.min;a.exports=function(a){return 0<a?f(d(a),9007199254740991):0}},function(a,b,c){var d=c(23),g=c(41),h=c(83);a.exports=function(b){return function(e,i,j){var k,l=d(e),c=g(l.length),m=h(j,c);if(b&&i!=i){for(;c>m;)if((k=l[m++])!=k)return!0;}else for(;c>m;m++)if((b||m in l)&&l[m]===i)return b||m||0;return!b&&-1}}},function(a,b,c){var d=c(13);a.exports=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==d(a)?a.split(""):Object(a)}},function(a){a.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}},function(a){a.exports={name:"jso",version:"4.1.1",description:"OAuth 2.0 implementation in Javascript",main:"dist/jso.js",module:"src/JSO.js",scripts:{test:"true",preversion:"npm test",version:"npm run build && git add -A dist",postversion:"git push && git push --tags && npm publish",build:"webpack --mode production --config webpack.config.js"},babel:{presets:["env"]},repository:{type:"git",url:"https://github.com/andreassolberg/jso.git"},keywords:["oauth","authentication","authorization","rest","api","ajax","jquery"],files:["src"],eslintConfig:{env:{es6:!0,browser:!0,node:!1}},devDependencies:{"babel-core":"^6.26.0","babel-loader":"^7.1.4","babel-preset-env":"^1.6.1","babel-preset-react":"^6.24.1",qunit:"^2.5.1",webpack:"^4.1.1","webpack-cli":"^2.0.12"},author:"Andreas \xC5kre Solberg",license:"LGPL-2.1",bugs:{url:"https://github.com/andreassolberg/jso/issues"},homepage:"https://github.com/andreassolberg/jso",dependencies:{}}},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),d=function(){function a(){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a)}return c(a,[{key:"on",value:function(a,b){this._callbacks||(this._callbacks={}),this._callbacks[a]||(this._callbacks[a]=[]),this._callbacks[a].push(b)}},{key:"emit",value:function(a){this._callbacks||(this._callbacks={}),this._callbacks[a]||(this._callbacks[a]=[]);for(var b=Array.prototype.slice.call(arguments,1),c=0;c<this._callbacks[a].length;c++)this._callbacks[a][c].apply(this,b)}}]),a}();b.default=d},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),d=function(){function a(){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a),this.config={};for(var b=0;b<arguments.length;b++)Object.assign(this.config,arguments[b])}return c(a,[{key:"has",value:function(a){var b=this.config,c=a.split("."),d=0;for(d=0;d<c.length;d++){if(!b.hasOwnProperty(c[d]))return!1;b=b[c[d]]}return!0}},{key:"getValue",value:function(a,b,c){c=c||!1;var d=this.config,e=a.split("."),f=0;for(f=0;f<e.length;f++){if(!d.hasOwnProperty(e[f])){d=void 0;break}d=d[e[f]]}if(void 0===d){if(c)throw new Error("Configuration option ["+e[f]+"] required but not provided.");return b}return d}}]),a}();b.default=d},function(b,c,d){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var e,f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=d(28),h=(e=g)&&e.__esModule?e:{default:e},i=function(){function a(){return function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a),function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}(a,h.default),f(a,[{key:"toString",value:function(){return"OAuthResponseError: ["+(this.error||"unknown")+"]: "+(this.error_description||"unknown")}}]),a}();c.default=i},function(b,c,d){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var e,f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=d(29),h=(e=g)&&e.__esModule?e:{default:e},i=function(){function a(b,c){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a),this.jso=b,this.jquery=c}return f(a,[{key:"_fetch",value:function(a,b){var c=this;return new Promise(function(d,f){return b.done=d,b.fail=function(a,b,d){return 401===parseInt(b,10)?(c.jso.wipeTokens(),f(new h.default)):f(d)},c.jquery.ajax(a,b)})}},{key:"fetch",value:function(a,b,c){var d=this;if(2<(c=c||0))throw new Error("Reccursion error. Expired tokens deleted and tried again multiple times.");var e={},f={mode:"cors"};return b&&(f=b,Object.assign(f,b)),b&&b.jso&&Object.assign(e,b.jso),this.jso.getToken(e).catch(function(a){console.error("Error fetching token to use ",a)}).then(function(e){return f.headers||(f.headers={}),f.headers.Authorization="Bearer "+e.access_token,d._fetch(a,f).catch(function(e){if(e instanceof h.default)return console.error("Token was expired. Deleting all tokens for this provider and get a new one",e),d.jso.wipeTokens(),d.fetch(a,b,c+1)})})}}]),a}();c.default=i},function(b,c,d){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var e,f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=d(29),h=(e=g)&&e.__esModule?e:{default:e},i=function(){function a(b){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a),this.jso=b}return f(a,[{key:"_fetch",value:function(a,b){return fetch(a,b).then(function(a){if(401===a.status)throw new h.default;return a})}},{key:"fetch",value:function(a,b,c){var d=this;if(2<(c=c||0))throw new Error("Reccursion error. Expired tokens deleted and tried again multiple times.");var e={},f={mode:"cors"};return b&&(f=b,Object.assign(f,b)),b&&b.jso&&Object.assign(e,b.jso),this.jso.getToken(e).catch(function(a){console.error("Error fetching token to use ",a)}).then(function(e){return f.headers||(f.headers={}),f.headers.Authorization="Bearer "+e.access_token,d._fetch(a,f).catch(function(e){if(e instanceof h.default)return console.error("Token was expired. Deleting all tokens for this provider and get a new one",e),d.jso.wipeTokens(),d.fetch(a,b,c+1)})})}}]),a}();c.default=i},function(b,c,d){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var e,f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=d(11),h=(e=g)&&e.__esModule?e:{default:e},i=function(){function a(){return function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a),function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}(a,h.default),f(a,[{key:"execute",value:function(){var a=this;return new Promise(function(b){window.popupCompleted=function(){var a=c.location.href;b(a)};var c=window.open(a.url,"jso-popup-auth","height=600,width=800");if(null===c)throw new Error("Error loading popup window");window.focus&&c.focus()})}}]),a}();c.default=i},function(b,c,d){"use strict";function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=e(d(11)),h=e(d(12)),i=function(){function a(b){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a);var c=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b));c.timeout=5e3,c.callback=null,c.isCompleted=!1,c.id="jso_passive_iframe_"+h.default.uuid();var d=window.addEventListener?"addEventListener":"attachEvent";return window[d],c.iframe=document.createElement("iframe"),c.iframe.setAttribute("id",c.id),c.iframe.setAttribute("src",b),c.iframe.addEventListener("load",function(){var a=null;try{if(c.iframe.contentWindow.location.hash){var b=c.iframe.contentWindow.location.hash.substring(1);a=h.default.parseQueryString(b)}else if(c.iframe.contentWindow.location.search){var d=c.iframe.contentWindow.location.search.substring(1);a=h.default.parseQueryString(d)}null===a?c._failed(new Error("Failed to obtain response value from iframe")):c._completed(a)}catch(a){}}),c}return function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}(a,g.default),f(a,[{key:"execute",value:function(){var a=this;return new Promise(function(b,c){a.callback=b,a.errorCallback=c,document.getElementsByTagName("body")[0].appendChild(a.iframe),setTimeout(function(){a._failed(new Error("Loading iframe timed out"))},a.timeout)})}},{key:"_cleanup",value:function(){var a=document.getElementById(this.id);a.parentNode.removeChild(a)}},{key:"_failed",value:function(a){this.isCompleted||(this.errorCallback&&"function"==typeof this.errorCallback&&this.errorCallback(a),this.isCompleted=!0,this._cleanup())}},{key:"_completed",value:function(a){this.isCompleted||(this.callback&&"function"==typeof this.callback&&this.callback(a),this.isCompleted=!0,this._cleanup())}}]),a}();c.default=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=d(c(11));d(c(12));var g=function(){function a(){return function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a),function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}(a,f.default),e(a,[{key:"execute",value:function(){var a=this;return new Promise(function(){window.location=a.url})}}]),a}();b.default=g},function(b,c,d){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var e,f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=d(12),h=(e=g)&&e.__esModule?e:{default:e},i=new(function(){function a(){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,a)}return f(a,[{key:"saveState",value:function(a,b){localStorage.setItem("state-"+a,JSON.stringify(b))}},{key:"getState",value:function(a){var b=JSON.parse(localStorage.getItem("state-"+a));return localStorage.removeItem("state-"+a),b}},{key:"hasScope",value:function(a,b){var c;if(!a.scopes)return!1;for(c=0;c<a.scopes.length;c++)if(a.scopes[c]===b)return!0;return!1}},{key:"filterTokens",value:function(b,c){var d,e,f,g=[],i=h.default.epoch();for(c||(c=[]),d=0;d<b.length;d++){for(f=!0,b[d].expires&&b[d].expires<i+1&&(f=!1),e=0;e<c.length;e++)this.hasScope(b[d],c[e])||(f=!1);f&&g.push(b[d])}return g}},{key:"saveTokens",value:function(a,b){localStorage.setItem("tokens-"+a,JSON.stringify(b))}},{key:"getTokens",value:function(a){var b=JSON.parse(localStorage.getItem("tokens-"+a));return b||(b=[]),h.default.log("Token found when loooking up provider "+a+" in store "+window.location.href,b),b}},{key:"wipeTokens",value:function(a){localStorage.removeItem("tokens-"+a)}},{key:"saveToken",value:function(a,b){var c=this.getTokens(a);(c=this.filterTokens(c)).push(b),this.saveTokens(a,c)}},{key:"getToken",value:function(a,b){var c=this.getTokens(a);return 1>(c=this.filterTokens(c,b)).length?null:c[0]}}]),a}());c.default=i},function(a,b,c){"use strict";var d=c(5),f=c(17),g=c(31);d(d.S,"Promise",{try:function(a){var b=f.f(this),c=g(a);return(c.e?b.reject:b.resolve)(c.v),b.promise}})},function(b,c,d){"use strict";var e=d(5),f=d(2),g=d(1),h=d(33),i=d(30);e(e.P+e.R,"Promise",{finally:function(a){var b=h(this,f.Promise||g.Promise),c="function"==typeof a;return this.then(c?function(c){return i(b,a()).then(function(){return c})}:a,c?function(c){return i(b,a()).then(function(){throw c})}:a)}})},function(a,b,c){var d=c(0)("iterator"),f=!1;try{var e=[7][d]();e.return=function(){f=!0},Array.from(e,function(){throw 2})}catch(a){}a.exports=function(a,b){if(!b&&!f)return!1;var c=!1;try{var e=[7],g=e[d]();g.next=function(){return{done:c=!0}},e[d]=function(){return g},a(e)}catch(a){}return c}},function(a,b,c){"use strict";var d=c(1),f=c(16),g=c(9),h=c(0)("species");a.exports=function(a){var b=d[a];g&&b&&!b[h]&&f.f(b,h,{configurable:!0,get:function(){return this}})}},function(a,b,c){var d=c(8);a.exports=function(a,b,c){for(var e in b)d(a,e,b[e],c);return a}},function(b,d,e){var g=e(1),f=e(32).set,h=g.MutationObserver||g.WebKitMutationObserver,i=g.process,j=g.Promise,a="process"==e(13)(i);b.exports=function(){var b,c,d,k=function(){var e,f;for(a&&(e=i.domain)&&e.exit();b;){f=b.fn,b=b.next;try{f()}catch(a){throw b?d():c=void 0,a}}c=void 0,e&&e.enter()};if(a)d=function(){i.nextTick(k)};else if(!(!h||g.navigator&&g.navigator.standalone)){var m=!0,o=document.createTextNode("");new h(k).observe(o,{characterData:!0}),d=function(){o.data=m=!m}}else if(j&&j.resolve){var p=j.resolve();d=function(){p.then(k)}}else d=function(){f.call(g,k)};return function(a){var e={fn:a,next:void 0};c&&(c.next=e),b||(b=e,d()),c=e}}},function(a){a.exports=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3]);}return a.apply(c,b)}},function(a,b,c){var d=c(19),f=c(0)("iterator"),g=c(6);a.exports=c(2).getIteratorMethod=function(a){if(null!=a)return a[f]||a["@@iterator"]||g[d(a)]}},function(a,b,c){var d=c(6),f=c(0)("iterator"),g=Array.prototype;a.exports=function(a){return void 0!==a&&(d.Array===a||g[f]===a)}},function(a,b,c){var d=c(3);a.exports=function(a,b,c,e){try{return e?b(d(c)[0],c[1]):b(c)}catch(b){var f=a.return;throw void 0!==f&&d(f.call(a)),b}}},function(b,d,e){var j=e(15),h=e(64),k=e(63),g=e(3),i=e(41),a=e(62),c={},l={};(d=b.exports=function(f,e,m,n,o){var p,q,r,s,t=o?function(){return f}:a(f),u=j(m,n,e?2:1),b=0;if("function"!=typeof t)throw TypeError(f+" is not iterable!");if(k(t)){for(p=i(f.length);p>b;b++)if((s=e?u(g(q=f[b])[0],q[1]):u(f[b]))===c||s===l)return s;}else for(r=t.call(f);!(q=r.next()).done;)if((s=h(r,u,q.value,e))===c||s===l)return s}).BREAK=c,d.RETURN=l},function(a){a.exports=function(a,b,c,d){if(!(a instanceof b)||void 0!==d&&d in a)throw TypeError(c+": incorrect invocation!");return a}},function(q,e,z){"use strict";var n,t,B,D,F=z(35),a=z(1),c=z(15),s=z(19),f=z(5),l=z(10),p=z(14),h=z(66),d=z(65),v=z(33),y=z(32).set,g=z(60)(),b=z(17),w=z(31),G=z(30),m=a.TypeError,k=a.process,H=a.Promise,J="process"==s(k),j=function(){},K=t=b.f,N=!!function(){try{var a=H.resolve(1),b=(a.constructor={})[z(0)("species")]=function(a){a(j,j)};return(J||"function"==typeof PromiseRejectionEvent)&&a.then(j)instanceof b}catch(a){}}(),O=function(a){var b;return l(a)&&"function"==typeof(b=a.then)&&b},E=function(b,a){if(!b._n){b._n=!0;var c=b._c;g(function(){for(var d=b._v,e=1==b._s,f=0,g=function(f){var g,h,j=e?f.ok:f.fail,k=f.resolve,a=f.reject,c=f.domain;try{j?(e||(2==b._h&&L(b),b._h=1),!0===j?g=d:(c&&c.enter(),g=j(d),c&&c.exit()),g===f.promise?a(m("Promise-chain cycle")):(h=O(g))?h.call(g,k,a):k(g)):a(d)}catch(b){a(b)}};c.length>f;)g(c[f++]);b._c=[],b._n=!1,a&&!b._h&&C(b)})}},C=function(b){y.call(a,function(){var c,d,e,f=b._v,g=P(b);if(g&&(c=w(function(){J?k.emit("unhandledRejection",f,b):(d=a.onunhandledrejection)?d({promise:b,reason:f}):(e=a.console)&&e.error&&e.error("Unhandled promise rejection",f)}),b._h=J||P(b)?2:1),b._a=void 0,g&&c.e)throw c.v})},P=function(a){return 1!==a._h&&0===(a._a||a._c).length},L=function(b){y.call(a,function(){var c;J?k.emit("rejectionHandled",b):(c=a.onrejectionhandled)&&c({promise:b,reason:b._v})})},M=function(a){var b=this;b._d||(b._d=!0,(b=b._w||b)._v=a,b._s=2,b._a||(b._a=b._c.slice()),E(b,!0))},I=function(a){var b,d=this;if(!d._d){d._d=!0,d=d._w||d;try{if(d===a)throw m("Promise can't be resolved itself");(b=O(a))?g(function(){var f={_w:d,_d:!1};try{b.call(a,c(I,f,1),c(M,f,1))}catch(a){M.call(f,a)}}):(d._v=a,d._s=1,E(d,!1))}catch(a){M.call({_w:d,_d:!1},a)}}};N||(H=function(a){h(this,H,"Promise","_h"),p(a),n.call(this);try{a(c(I,this,1),c(M,this,1))}catch(a){M.call(this,a)}},(n=function(){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=z(59)(H.prototype,{then:function(a,b){var c=K(v(this,H));return c.ok="function"!=typeof a||a,c.fail="function"==typeof b&&b,c.domain=J?k.domain:void 0,this._c.push(c),this._a&&this._a.push(c),this._s&&E(this,!1),c.promise},catch:function(a){return this.then(void 0,a)}}),B=function(){var a=new n;this.promise=a,this.resolve=c(I,a,1),this.reject=c(M,a,1)},b.f=K=function(a){return a===H||a===D?new B(a):t(a)}),f(f.G+f.W+f.F*!N,{Promise:H}),z(18)(H,"Promise"),z(58)("Promise"),D=z(2).Promise,f(f.S+f.F*!N,"Promise",{reject:function(a){var b=K(this);return(0,b.reject)(a),b.promise}}),f(f.S+f.F*(F||!N),"Promise",{resolve:function(a){return G(F&&this===D?H:this,a)}}),f(f.S+f.F*!(N&&z(57)(function(a){H.all(a).catch(j)})),"Promise",{all:function(a){var b=this,c=K(b),f=c.resolve,g=c.reject,e=w(function(){var h=[],j=0,k=1;d(a,!1,function(d){var i=j++,a=!1;h.push(void 0),k++,b.resolve(d).then(function(b){a||(a=!0,h[i]=b,--k||f(h))},g)}),--k||f(h)});return e.e&&g(e.v),c.promise},race:function(a){var b=this,c=K(b),f=c.reject,e=w(function(){d(a,!1,function(a){b.resolve(a).then(c.resolve,f)})});return e.e&&f(e.v),c.promise}})},function(a){a.exports=function(a,b){return{value:b,done:!!a}}},function(a,b,c){"use strict";var d=c(37),f=c(68),e=c(6),g=c(23);a.exports=c(36)(Array,"Array",function(a,b){this._t=g(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,f(1)):f(0,"keys"==b?c:"values"==b?a[c]:[c,a[c]])},"values"),e.Arguments=e.Array,d("keys"),d("values"),d("entries")},function(j,e,k){for(var m=k(69),n=k(24),o=k(8),i=k(1),q=k(4),a=k(6),c=k(0),r=c("iterator"),f=c("toStringTag"),l=a.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=n(p),d=0;d<h.length;d++){var s,t=h[d],g=p[t],b=i[t],u=b&&b.prototype;if(u&&(u[r]||q(u,r,l),u[f]||q(u,f,t),a[t]=l,g))for(s in m)u[s]||o(u,s,m[s],!0)}},function(a,b,c){var d=c(7),f=c(38),g=c(20)("IE_PROTO"),h=Object.prototype;a.exports=Object.getPrototypeOf||function(a){return a=f(a),d(a,g)?a[g]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?h:null}},function(a,b,c){var d=c(16),f=c(3),g=c(24);a.exports=c(9)?Object.defineProperties:function(b,e){f(b);for(var h,i=g(e),j=i.length,a=0;j>a;)d.f(b,h=i[a++],e[h]);return b}},function(b,d,f){var g=f(3),h=f(72),j=f(39),i=f(20)("IE_PROTO"),k=function(){},a=function(){var b,c=f(26)("iframe"),d=j.length;for(c.style.display="none",f(34).appendChild(c),c.src="javascript:",(b=c.contentWindow.document).open(),b.write("<script>document.F=Object</script>"),b.close(),a=b.F;d--;)delete a.prototype[j[d]];return a()};b.exports=Object.create||function(b,c){var d;return null===b?d=a():(k.prototype=g(b),d=new k,k.prototype=null,d[i]=b),void 0===c?d:h(d,c)}},function(a,b,c){"use strict";var d=c(73),f=c(44),g=c(18),h={};c(4)(h,c(0)("iterator"),function(){return this}),a.exports=function(a,b,c){a.prototype=d(h,{next:f(1,c)}),g(a,b+" Iterator")}},function(a,b,c){var d=c(21),f=c(22);a.exports=function(b){return function(e,g){var h,j,k=f(e)+"",a=d(g),c=k.length;return 0>a||a>=c?b?"":void 0:55296>(h=k.charCodeAt(a))||56319<h||a+1===c||56320>(j=k.charCodeAt(a+1))||57343<j?b?k.charAt(a):h:b?k.slice(a,a+2):j-56320+(h-55296<<10)+65536}}},function(a,b,c){"use strict";var d=c(75)(!0);c(36)(String,"String",function(a){this._t=a+"",this._i=0},function(){var a,b=this._t,c=this._i;return c>=b.length?{value:void 0,done:!0}:(a=d(b,c),this._i+=a.length,{value:a,done:!1})})},function(a,b,c){"use strict";var d=c(19);({})[c(0)("toStringTag")]="z",c(8)(Object.prototype,"toString",function(){return"[object "+d(this)+"]"},!0)},function(a,b,c){c(77),c(76),c(70),c(67),c(56),c(55),a.exports=c(2).Promise},function(a,b,c){"use strict";var d=c(5),f=c(42)(!0);d(d.P,"Array",{includes:function(a){return f(this,a,1<arguments.length?arguments[1]:void 0)}}),c(37)("includes")},function(a,b,c){c(79),a.exports=c(2).Array.includes},function(a,b){b.f={}.propertyIsEnumerable},function(a,b){b.f=Object.getOwnPropertySymbols},function(a,b,c){var d=c(21),f=Math.max,g=Math.min;a.exports=function(a,b){return 0>(a=d(a))?f(a+b,0):g(a,b)}},function(a,b,c){var d=c(7),f=c(23),e=c(42)(!1),g=c(20)("IE_PROTO");a.exports=function(b,h){var i,j=f(b),a=0,k=[];for(i in j)i!=g&&d(j,i)&&k.push(i);for(;h.length>a;)d(j,i=h[a++])&&(~e(k,i)||k.push(i));return k}},function(b,d,e){"use strict";var g=e(24),j=e(82),k=e(81),i=e(38),m=e(43),a=Object.assign;b.exports=!a||e(27)(function(){var b={},c={},d=Symbol();return b[d]=7,"abcdefghijklmnopqrst".split("").forEach(function(a){c[a]=a}),7!=a({},b)[d]||Object.keys(a({},c)).join("")!="abcdefghijklmnopqrst"})?function(a){for(var b=i(a),e=arguments.length,c=1,n=j.f,f=k.f;e>c;)for(var l,o=m(arguments[c++]),h=n?g(o).concat(n(o)):g(o),d=h.length,q=0;d>q;)f.call(o,l=h[q++])&&(b[l]=o[l]);return b}:a},function(a,b,c){var d=c(10);a.exports=function(a,b){if(!d(a))return a;var c,e;if(b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;if("function"==typeof(c=a.valueOf)&&!d(e=c.call(a)))return e;if(!b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;throw TypeError("Can't convert object to primitive value")}},function(a,b,c){a.exports=!c(9)&&!c(27)(function(){return 7!=Object.defineProperty(c(26)("div"),"a",{get:function(){return 7}}).a})},function(a,b,c){var d=c(5);d(d.S+d.F,"Object",{assign:c(85)})},function(a,b,c){c(88),a.exports=c(2).Object.assign},function(j,e,k){"use strict";function m(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(e,"__esModule",{value:!0}),e.FetcherJQuery=e.Fetcher=e.IFramePassive=e.Popup=e.HTTPRedirect=e.BasicLoader=e.JSO=void 0;var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},n=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),q=m(k(89));k(80),k(78);var i=m(k(54)),x=m(k(12)),a=m(k(11)),c=m(k(53)),o=m(k(52)),f=m(k(51)),l=m(k(50)),p=m(k(49)),h=m(k(48)),d=m(k(47)),r=m(k(46));k(45);var s={lifetime:3600},b=function(){function b(a){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,b);var d=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.configure(a),d.providerID=d.getProviderID(),d.Loader=c.default,d.store=i.default,d.callbacks={},d.config.getValue("debug",!1)&&(x.default.debug=!0),d}return function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}(b,r.default),n(b,[{key:"configure",value:function(a){this.config=new d.default(s,a)}},{key:"setStore",value:function(a){this.store=a}},{key:"setLoader",value:function(a){if("function"!=typeof a)throw new Error("loader MUST be an instance of the JSO BasicLoader");this.Loader=a}},{key:"getProviderID",value:function(){var a=this.config.getValue("providerID",null);if(null!==a)return a;var b=this.config.getValue("client_id",null,!0);return this.config.getValue("authorization",null,!0)+"|"+b}},{key:"processTokenResponse",value:function(a){var b;if(!a.state)throw new Error("Could not get state from storage.");if(!(b=this.store.getState(a.state)))throw new Error("Could not retrieve state");if(!b.providerID)throw new Error("Could not get providerid from state");return x.default.log("processTokenResponse ",a,""),this.processReceivedToken(a,b)}},{key:"processReceivedToken",value:function(a,b){var c=x.default.epoch();return a.received=c,a.expires_in?(a.expires=c+parseInt(a.expires_in,10),a.expires_in=parseInt(a.expires_in,10)):!1===this.config.getValue("default_lifetime",null)?a.expires=null:this.config.has("permanent_scope")?this.store.hasScope(a,this.config.getValue("permanent_scope"))||(a.expires=null):this.config.has("default_lifetime")?a.expires=c+this.config.getValue("default_lifetime"):a.expires=c+3600,a.scope?(a.scopes=a.scope.split(" "),delete a.scope):b.scopes?a.scopes=b.scopes:a.scopes=[],x.default.log("processTokenResponse completed ",a,""),this.store.saveToken(b.providerID,a),window.location.hash=b.restoreHash?b.restoreHash:"",a}},{key:"processAuthorizationCodeResponse",value:function(a){var b=this;console.log(this),this.emit("authorizationCode",a);var c;if(!a.state)throw new Error("Could not find state paramter from callback.");if(null===(c=this.store.getState(a.state)))throw new Error("Could not find retrieve state object.");if(console.log("state",c),this.config.has("token")){if(!this.config.has("client_secret"))throw new Error("Configuration missing [client_secret]");var d=new Headers;d.append("Authorization","Basic "+btoa(this.config.getValue("client_id")+":"+this.config.getValue("client_secret"))),d.append("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");var e={grant_type:"authorization_code",code:a.code};c.hasOwnProperty("redirect_uri")&&(e.redirect_uri=c.redirect_uri);var f={mode:"cors",headers:d,method:"POST",body:x.default.encodeQS(e)};return fetch(this.config.getValue("token"),f).then(function(a){return a.json()}).then(function(a){return x.default.log("Received response on token endpoint ",a,""),b.processReceivedToken(a,c)})}x.default.log("Received an authorization code. Will not process it as the config option [token] endpoint is not set. If you would like to process the code yourself, please subscribe to the [authorizationCode] event")}},{key:"processErrorResponse",value:function(a){var b;if(!a.state)throw new Error("Could not get [state] and no default providerid is provided.");if(!(b=this.store.getState(a.state)))throw new Error("Could not retrieve state");if(!b.providerID)throw new Error("Could not get providerid from state");return window.location.hash=b.restoreHash?b.restoreHash:"",new h.default(a)}},{key:"callback",value:function(a){var b=null;if("object"===(void 0===a?"undefined":g(a)))b=a;else if("string"==typeof a)b=x.default.getResponseFromURL(a);else{if(void 0!==a)return;b=x.default.getResponseFromURL(window.location.href)}if(x.default.log("Receving response in callback",b),b.hasOwnProperty("access_token"))return this.processTokenResponse(b);if(b.hasOwnProperty("code"))return this.processAuthorizationCodeResponse(b);if(b.hasOwnProperty("error"))throw this.processErrorResponse(b)}},{key:"dump",value:function(){var a=this.store.getTokens(this.providerID);return{providerID:this.providerID,tokens:a,config:this.config}}},{key:"_getRequestScopes",value:function(a){var b,c=[];if(this.config.has("scopes.request")){var d=this.config.getValue("scopes.request");for(b=0;b<d.length;b++)c.push(d[b])}if(a&&a.scopes&&a.scopes.request)for(b=0;b<a.scopes.request.length;b++)c.push(a.scopes.request[b]);return x.default.uniqueList(c)}},{key:"_getRequiredScopes",value:function(a){var b,c=[];if(this.config.has("scopes.require")){var d=this.config.getValue("scopes.require");for(b=0;b<d.length;b++)c.push(d[b])}if(a&&a.scopes&&a.scopes.require)for(b=0;b<a.scopes.require.length;b++)c.push(a.scopes.require[b]);return x.default.uniqueList(c)}},{key:"getToken",value:function(a){var b=this;return a=a||{},new Promise(function(c){var d=b._getRequiredScopes(a),e=b.store.getToken(b.providerID,d);if(e)return c(e);if(a.hasOwnProperty("allowredir")&&!a.allowredir)throw new Error("Cannot obtain a token, when not allowed to redirect...");c(b._authorize(a))})}},{key:"checkToken",value:function(a){var b=this._getRequiredScopes(a);return this.store.getToken(this.providerID,b)}},{key:"_authorize",value:function(a){var b,d,e,g=this;return Promise.resolve().then(function(){var h,i=g.config.getValue("authorization",null,!0),c=g.config.getValue("client_id",null,!0);if(a.hasOwnProperty("allowia")||g.config.has("allowia"))throw new Error("The allowia option was removed in JSO 4.1.0. Instead use {request: {prompt: \"none\"}}");if(x.default.log("About to send an authorization request to this endpoint",i),x.default.log("Options",a),b={},g.config.has("request")){var j=g.config.getValue("request");b=(0,q.default)(b,j)}if(a.hasOwnProperty("request")&&(b=(0,q.default)(b,a.request)),b.response_type=a.response_type||g.config.getValue("response_type","id_token token"),b.state=x.default.uuid(),g.config.has("redirect_uri")&&(b.redirect_uri=g.config.getValue("redirect_uri","")),a.redirect_uri&&(b.redirect_uri=a.redirect_uri),b.client_id=c,h=(e=g._getRequestScopes(a)).includes("openid"),0<e.length&&(b.scope=x.default.scopeList(e)),x.default.log("Running in mode: "+(h?"OpenID Connect mode":"OAuth mode")),h&&!b.hasOwnProperty("redirect_uri"))throw new Error("An OpenID Request requires a redirect_uri to be set. Please add to configuration. A redirect_uri is not required for plain OAuth");h&&(b.nonce=x.default.uuid()),x.default.log("Debug Authentication request object",JSON.stringify(b,void 0,2)),d=x.default.encodeURL(i,b),window.location.hash&&(b.restoreHash=window.location.hash),b.providerID=g.providerID,e&&(b.scopes=e),x.default.log("Saving state ["+b.state+"]"),x.default.log(JSON.parse(JSON.stringify(b)));var f=g.Loader;return a.hasOwnProperty("loader")&&(f=a.loader),x.default.log("Looking for loader",a,f),g.store.saveState(b.state,b),g.gotoAuthorizeURL(d,f).then(function(a){if(!0!==a)return g.callback(a)})})}},{key:"gotoAuthorizeURL",value:function(b,c){return new Promise(function(d,e){if(null!==c&&"function"==typeof c){var f=new c(b);if(!(f instanceof a.default))throw new Error("JSO selected Loader is not an instance of BasicLoader.");d(f.execute())}else e(new Error("Cannot redirect to authorization endpoint because of missing redirect handler"))})}},{key:"wipeTokens",value:function(){this.store.wipeTokens(this.providerID)}}]),b}();e.JSO=b,e.BasicLoader=a.default,e.HTTPRedirect=c.default,e.Popup=f.default,e.IFramePassive=o.default,e.Fetcher=l.default,e.FetcherJQuery=p.default}])}),imported.src="./js/jso.js",document.head.appendChild(imported);var config={response_type:"code",client_id:"",authorization:"https://api.pgsmartshopassistant.com/o/authorize/",redirect_uri:""};class PG{constructor(){}Init(){let a=new jso.JSO(config);a.getToken()}setClientId(a){config.client_id=a}setRedirectUrl(a){config.redirect_uri=a}}
